<html>
<head>
<title> Karaoke </title>

<script src="lyrics.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>  
<script src="http://cdn-files.deezer.com/js/min/dz.js"></script>

</head>

<style>

#trackList{
	float:left;
	right: 80px;
	top: 40px;
	text-align:left;
}

#currentTrack {
	font-weight: bold;
	margin-bottom:10px;
}
a{
	color: blue;
	text-decoration:none;
}

#lyrics {
	z-index: 15;
	font-weight: bold;
	text-align: center;
	width: 480px;
	height: 270px;
	color:white;
	padding-top:5px;
	position: absolute;
}

#video {
   z-index:1;
   float:left;
}

#content{
	/*width: 800px;*/
	text-align:center;
	font-size: 20px;
	padding:10px;
}
</style>
<body>

<script>
console.log("START Karaoke");
//lyrics = getTrackLyrics("Help","Beatles");
//console.log("current track lyrics", lyrics);

var karaokePlaying = 0;
var karaokeCurrentTime = 0;


DZ.init({
	appId  : '116247',
	channelUrl : 'http://kadrik.github.io/deezerkaraoke/'
});
DZ.ready(function() {
	DZ.Event.subscribe('current_track', function(track, evt_name){
		console.log("current track object", track);
		title = track.track.title;
		artist = track.track.artist.name;
		duration = track.track.duration;
		$("#currentTrack").html(title +" <i>By</i> "+ artist);
		lyrics = getTrackLyrics(title, artist, duration, function() {
			if (lyrics != null) {
				console.log("current track lyrics", lyrics);
				//$("#lyrics").html(getWholeLyrics(lyrics));
			}
			else {
				//$("#lyrics").html("");				
			}
		});
	});
        DZ.Event.subscribe('player_play', function(args, evt_name){
           karaokePlaying = 1;
           karaokeCurrentTime = 0;
           //setTimeout(displayLyrics, 500);
           //$("#dynamiclyrics2").html("");           
           //$("#dynamiclyrics1").html("");
        });
        DZ.Event.subscribe('player_position', function(args, evt_name){
        console.log("position changed", args[0]);
           karaokeCurrentTime = args[0];
           displayLyrics();
        });
        DZ.Event.subscribe('player_paused', function(args, evt_name){
           karaokePlaying = 0;
        });

});


function play(trackId) {
	DZ.player.playTracks([trackId], 0, function(response){
                
		console.log("track list", response.tracks);
	});	
}

var currentText = "";
var currentId = 0;
function displayLyrics()
{
//   karaokeCurrentTime+=0.5;
   tmp = getLyricsWithTime(karaokeCurrentTime);
   if (currentText != tmp)
   {
	  $("#lyrics").append('<div id="lyricsdiv'+currentId+'">'+currentText+'</div>');
	
	$('#lyricsdiv'+currentId).animate({
	    margin-top: '+=50',
	  }, 5000, function() {
	    // Animation complete.
	  });
	
	/*  if ($("#dynamiclyrics2").html() == "")
      {
        $("#dynamiclyrics2").html(getLyricsWithTime(karaokeCurrentTime));
      }
      else
      {
        $("#dynamiclyrics1").html(getLyricsWithTime(karaokeCurrentTime));
        $("#dynamiclyrics2").html("");
      }*/
   }
	currentText = tmp;
   //if (karaokePlaying)
     //setTimeout(displayLyrics, 500);
}

function playVideo(iD) {
	
	deeZerTrackId = 1 ;
	$("#video").html("<video width='480' autoplay loop><source src='1.avi'type='video/mp4'></video");				
}
	//DZ.player.playTracks([deeZerTrackId], 0, function(response){                
	//	console.log("track list", response.tracks);
	//});	
	//$("#lyrics").html("");				
//}

console.log("END Karaoke");
playVideo(1);
</script>


<div id="content">
	<div id="currentTrack"></div>
	<div id="video">
		<video width="480" autoplay loop>
  			<source src="background.mp4" type='video/mp4'> 
		</video>
	</div>	
	<div id="trackList">

		<ul>
			<li><a href="#" onClick="play(4601933)"> Bad romance <i>by</i> Lady Gaga</a>
			<li><a href="#" onClick="play(12565421)"> Sexy and I know it <i>by</i> LMFAO </a>
			<li><a href="#" onClick="playVideo(1)"> Get Lucky <i>by</i> Daft Punk </a>
			<li><a href="#" onClick="play(10420672)"> Like a Hobo <i>by</i> Charlie Winston </a>
 			<li><a href="#" onClick="play(3135553)">One More Time <i>by</i> Daft Punk </a>
		
		</ul>
		<!--a href="http://ourdomainname.com"> ourdomainname.com </a-->
	</div>

	<div id="lyrics">
		<!--div id="dynamiclyrics1"></div>
		<div id="dynamiclyrics2"></div-->
	</div>
</div>


<div id="debug">
</div>
</body>
</html>
