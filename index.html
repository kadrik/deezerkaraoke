<html>
<head>
<title> Karaoke </title>

<script src="lyrics.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>  
<script src="http://cdn-files.deezer.com/js/min/dz.js"></script>

</head>

<style>
#trackList{
	float:right;
	right: 20px;
	top: 20px;
}
</style>
<body>

<script>
console.log("START Karaoke");
//lyrics = getTrackLyrics("Help","Beatles");
//console.log("current track lyrics", lyrics);

var karaokePlaying = 0;
var karaokeCurrentTime = 0;


DZ.init({
	appId  : '116247',
	channelUrl : 'http://kadrik.github.io/deezerkaraoke/'
});
DZ.ready(function() {
	DZ.Event.subscribe('current_track', function(track, evt_name){
		console.log("current track object", track);
		title = track.track.title;
		artist = track.track.artist.name;
		duration = track.track.duration;
		$("#currentTrack").html(title +" <i>By</i> "+ artist);
		lyrics = getTrackLyrics(title, artist, duration, function() {
			if (lyrics != null) {
				console.log("current track lyrics", lyrics);
				$("#lyrics").html(getWholeLyrics(lyrics));
			}
			else {
				$("#lyrics").html("");				
			}
		});
	});
        DZ.Event.subscribe('player_play', function(args, evt_name){
           karaokePlaying = 1;
           karaokeCurrentTime = 0;
           //setTimeout(displayLyrics, 500);
           //$("#dynamiclyrics2").html("");           
           //$("#dynamiclyrics1").html("");
        });
        DZ.Event.subscribe('player_position', function(args, evt_name){
        console.log("position changed", args[0]);
           karaokeCurrentTime = args[0];
           displayLyrics();
        });
        DZ.Event.subscribe('player_paused', function(args, evt_name){
           karaokePlaying = 0;
        });

});


function play(trackId) {
	DZ.player.playTracks([trackId], 0, function(response){
                
		console.log("track list", response.tracks);
	});	
}

var currentText = "";
function displayLyrics()
{
//   karaokeCurrentTime+=0.5;
   tmp = getLyricsWithTime(karaokeCurrentTime);
   if (currentText != tmp)
      if ($("#dynamiclyrics2").html() == "")
      {
        $("#dynamiclyrics2").html(getLyricsWithTime(karaokeCurrentTime));
      }
      else
      {
        $("#dynamiclyrics1").html(getLyricsWithTime(karaokeCurrentTime));
        $("#dynamiclyrics2").html("");
      }
   currentText = tmp;
   //if (karaokePlaying)
     //setTimeout(displayLyrics, 500);
}

function playVideo(iD) {
	
	deeZerTrackId = 1 ;
	
	DZ.player.playTracks([deeZerTrackId], 0, function(response){                
		console.log("track list", response.tracks);
	});
	
	$("#lyrics").html("1.avi");				
	
	return "1.avi";
}

console.log("END Karaoke");
playVideo(1);
</script>

<video=1.avi>
<video width="320" height="240" controls>
	<source src="1.mov">
</video>
	
<div id="trackList">
	<script src="trackList.js" type="text/javascript"></script>

	<ul>
	<li><a href="#" onClick="play(4601933)"> Bad romance <i>by</i> Lady Gaga</a>
	<li><a href="#" onClick="play(12565421)"> Sexy and I know it <i>by</i> LMFAO </a>
	<li><a href="#" onClick="playVideo(1)"> Get Lucky <i>by</i> Daft Punk </a>
	<li><a href="#" onClick="play(10420672)"> Like a Hobo <i>by</i> Charlie Winston </a>
 	<li><a href="#" onClick="play(3135553)">One More Time <i>by</i> Daft Punk </a>
		
	</ul>
	<h1><a href="http://ourdomainname.com"> ourdomainname.com </a></h1>
</div>

<div id="dynamiclyrics1">
</div>
<div id="dynamiclyrics2">
</div>

<div id=video>
	<video width="560" height="340" controls>
	  <source src="background.mp4" type='video/mp4'> 
	</video>
</div>
<br><br>

<div id="currentTrack">
</div>

<div id="lyrics">
</div>


<div id="debug">
</div>
</body>
</html>
